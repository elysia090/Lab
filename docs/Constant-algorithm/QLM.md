Phenotype AI: constant-size representation-to-learning via QMS-256 and a filtered dgLA Cech backbone

Abstract
We present a peer-review-grade, end-to-end stack whose online cost per token is constant and independent of expression depth and cover size. Inputs are byte streams encoded by QMS-256 into a projective SU(2) state with optional SL(2,C) spikes and idempotent normalization, then lifted to local 0-forms. Gluing and differentiation are governed by a filtered, complete differential graded Lie algebra (dgLA) of graded derivations on the total complex of a finite good cover. A degree-1 Maurer–Cartan element mu (Robin transmission) yields a square-zero total differential D_mu = D + mu, and a filtered homological perturbation produces a bounded contraction to de Rham cohomology. With fixed offline operator envelopes, all forward-, reverse-, and mixed-mode Jacobian products execute in O(1). We provide explicit hypotheses, constants, proofs (sketches), error bounds, and a minimal ABI.
	0.	Conventions and computation model
Spaces are complex Banach or Hilbert scales H^s(U_S;Lambda^p) with bounded restrictions. Operator norms ||·|| are taken on the chosen scales. A finite good cover U={U_i} has overlap multiplicity nu. A band-limit K bounds local representation size. The online model is a unit-cost RAM with fixed-size complex dense linear algebra; a single 2x2 complex multiply is O(1). All O(1) statements mean independence from token length T, number of patches P, and expression depth.
	1.	Total complex and filtered dgLA
Manifold and cover
Let M be paracompact C^infty, and U a finite good cover. For p,q>=0 define
C^q(U;Omega^p) = product_{|S|=q+1} Omega^p(U_S), U_S = intersection_{i in S} U_i.
Tot^N = direct sum_{p+q=N} C^q(U;Omega^p), Tot = direct sum_{N>=0} Tot^N.

Total differential
Let d be the exterior derivative and delta the Cech coboundary. On form degree p set delta_tot := (-1)^p delta. Define D := d + delta_tot.

dgLA of derivations
Let Der(Tot) be graded derivations of Tot with graded commutator [A,B] = A B - (-1)^{|A||B|} B A. The differential is ad_D = [D, ·]; then (Der(Tot), [·,·], ad_D) is a dgLA.

Filtered completeness
Equip Der(Tot) with a complete Hausdorff descending filtration F^m by (Cech degree) + (local operator order) so that F^1 is pronilpotent and complete. Convergence is in the filtered norm ||·||_F.
	2.	QMS-256 front end (degree-0 functor)
State and charts
Maintain psi in C^2 \ {0}. Use dual charts z = u/v and z’ = v/u. Select the chart with |den| >= tau_den. Normalization e fixes ||psi||=1 and a phase; e(e(psi)) = e(psi). The Jacobian of e is a bounded projector on C^2 \ {0}.

Byte-to-SU(2)
A fixed 256-entry LUT maps b in {0..255} to q_b (unit quaternion). Embed q = w + x i + y j + z k to SU(2) via
a := w + i z, bq := x + i y, U(q) = [[a, bq], [-conj(bq), conj(a)]].
Per token: psi <- e(U(q_b) psi).

Optional spikes
Finite set {S_ell} subset SL(2,C). If a 1-bit gate is on, apply psi <- e(S_ell psi). All actions are degree 0.

Lift into local forms
For each patch U_i, choose basis {phi_{i,k}}_{k=1..K} subset Omega^0(U_i) and bounded linear C_i in C^{Kx2}. Set psi_i = C_i psi.

Exact decode
Store b per token and return it for exact inversion.

Operator envelopes
Unitary U(q_b) have ||U||=1. Record b_S >= sup_ell sup_s ||exp(s G_ell)|| for S_ell = exp(s G_ell). Record c_lift >= sup_i ||C_i||. These are offline constants.
	3.	Degree-0 actions, gauge, and BCH
Let g^0 subset Der^0(Tot) be generated by L_X (Lie derivative), J_c (degree-0 incidence actions), lift operators, and QMS blocks. Degree-0 flows act by gauge on Maurer–Cartan data. For Theta in g^0,
mu |-> mu^Theta := e^{ad_Theta} mu - (e^{ad_Theta}-1) ad_Theta^{-1} [D,Theta].
The degree-0 subgroup exp(g^0) factorizes by BCH into commuting exponentials for L_X and J_c (and constant-size blocks for QMS); reordering is uniform and constant-size.
	4.	Robin transmission as a Maurer–Cartan element
Definition (Maurer–Cartan)
mu in Der^1(Tot) is MC if ad_D mu + (1/2)[mu,mu] = 0. Then D_mu := D + mu satisfies D_mu^2 = 0.

Concrete mu (Robin form)
On q=0, for psi=(psi_i)i and overlaps U{ij},
(mu psi){ij} := alpha (psi_i - psi_j) + beta{ij} L_X (psi_i + psi_j),
extended to Tot as a derivation. Here alpha>0, beta_{ij}>0, and X is a bounded vector field.

Cartan identities
iota_X has degree -1, L_X = [d,iota_X] degree 0. On Tot, [delta_tot, iota_X] = 0, hence [D, iota_X] = L_X. These identities pass to D_mu by the MC condition.

Edge curvature identity
On homogeneous form degree p, the q:0->2 component of D_mu^2 = 0 is
delta_tot (alpha E psi + beta L_X S psi) + mu (alpha E psi + beta L_X S psi) + [d, mu] psi = 0,
where E,S are edge difference/sum derivations and [d,mu] = [L_X, alpha E + beta S] on q=0.
	5.	Filtered homological perturbation and bounds
Contraction data
Let (iota, pi, h) be a bounded contraction between (Omega^(M), d) and (Tot^, D): pi iota = id, iota pi = id - D h - h D.

Convergence condition
Let gamma := ||h|| * ||mu||_F. Assume gamma < 1.

Perturbed homotopy
h_mu := h sum_{m>=0} (- mu h)^m converges in the filtered norm. Then (iota, pi, h_mu) is a contraction between (Omega^, d) and (Tot^, D_mu).

Truncation error
Truncating at order m yields a tail tau_m <= gamma^{m+1} / (1 - gamma). All constants are independent of P and expression depth.
	6.	Differentiation templates (constant-size)
Blocks
Linear: U(q_b), S_ell, e, C_i, D_mu, iota_X, L_X, J_c, iota, pi, h_mu. Pointwise: smooth gates and bounded Phi_k operating componentwise on local coordinates.

JVP
Apply graded derivation rules; reorder degree-0 blocks by the BCH split; multiply constant-size matrices. For parameter t affecting mu,
d h_mu / d t = - h S ( d mu / d t h ) S with S := sum_{m>=0} (- mu h)^m, truncated at fixed m.

VJP and HVP
Replace each block by its adjoint; use h_mu^* with the same truncation. Composition yields HVP. All costs are constant-size.
	7.	Learnable parameter manifolds and feasibility
Parameters
theta_R: alpha = exp(a), beta_{ij} = exp(b_{ij}), X = sum_r w_r X_r.
theta_QMS: SU(2) conjugation Q = exp(A) with A in su(2); spikes S_ell = exp(s_ell G_ell) with gates s_ell in [0,1], tau >= tau_min; lift maps C_i (optionally with Stiefel constraints).

Feasible set and barrier
Define rho_eff := ||h|| * ( alpha ||E|| + ||beta|| ||S|| ||L_X|| ), using offline envelopes for ||E||, ||S||, ||L_X||, and ||beta||. Feasible F = { rho_eff < 1 }. Use barrier B(theta) = -log(1 - rho_eff(theta)) and project to F after each step. All checks are constant-size.

Gradients (constant-size)
d mu / d alpha = E
d mu / d beta_{ij} = P_{ij} L_X S
d mu / d w_r = beta L_{X_r} S
d U’ / d A [Delta] = [Delta, U’] at A near 0; use Lie integral otherwise
d S_ell / d s_ell = G_ell exp(s_ell G_ell)
All Jacobians and adjoints are 2x2 or Kx2 blocks with fixed envelopes.
	8.	Complexity and correctness
Theorem (algebraic soundness)
If mu solves the MC equation, then D_mu^2 = 0 and [D_mu, iota_X] = L_X, [D_mu, L_X] = 0.

Theorem (filtered HPL)
Under gamma < 1, (iota, pi, h_mu) is a contraction; truncation tail tau_m <= gamma^{m+1}/(1 - gamma).

Theorem (constant-time AD)
Fix nu, K, p_max, and truncation m. Any expression generated by the blocks above has JVP, VJP, and HVP that execute with a constant number of constant-size multiplies; time and memory are O(1) per token and independent of P and expression depth.
	9.	Numerical stability
Dual-chart policy with threshold tau_den prevents denominator underflow; e is idempotent, nonexpansive off the origin, and has a bounded adjoint. Unitary U(q_b) imply condition number 1; spikes obey recorded spectral bounds b_S; lift maps are bounded by c_lift. Finite precision is handled by chart switching, rescaling, and optional clipping of spike parameters.
	10.	Minimal ABI
init_qms(LUT, {S_ell}, e, {C_i}, tau_den, tau_min)
init_cech(E, S, L_X, {J_c}, iota, pi, h, truncation_m, envelopes)
forward_token(b, flags, psi_in) -> (psi_out, {psi_i})
jvp_token(b, flags, psi, v) -> outputs
vjp_token(b, flags, psi, adj) -> outputs
update_params(grad_theta) with retractions and projection to F
certify(theta) -> pass/fail
	11.	Worked micro-example
M = S^1, two patches U_1, U_2, K = 1. mu on overlaps is scalar. Per byte: one SU(2) multiply, optional spike, normalization, two lifts. D_mu curvature identity reduces to a single overlap equation. JVP/VJP/HVP are visible as compositions of constant-size blocks.
	12.	Reproducibility checklist
Cover and bases; nu, K, p_max. Tables and adjoints for E, S, L_X, J_c; contraction (iota, pi, h); truncation m and tail bound. QMS LUT b -> q_b (or a finite subgroup Cayley table), matrices U(q_b), spikes, normalization e, lifts C_i with adjoints. Operator envelopes for certification. Reference kernels and tests including pole-near cases and gating extremes.
	13.	Limitations
O(1) guarantees assume fixed good cover pattern, fixed K and p_max, bounded Phi_k derivatives, and rho_eff < 1. Nonlocal nonlinearities must factor through degree-0 incidence to keep templates closed. The finite-subgroup option trades angular resolution for exact algebraic closure.

Proof sketches for key identities
	1.	[delta_tot, iota_X] = 0: delta_tot acts on Cech indices with sign (-1)^p; iota_X acts on forms; degrees commute, so graded sign cancels. Hence [D, iota_X] = [d, iota_X] = L_X.
	2.	[d, mu] on q=0: d is a derivation and L_X = [d, iota_X] gives [d, alpha E] = 0, [d, beta L_X S] = [L_X, beta S]; extend derivationally to all q. The MC equation ad_D mu + (1/2)[mu,mu] = 0 expands to the edge identity written above.
	3.	Filtered HPL: with gamma < 1, S = sum_{m>=0} (- mu h)^m converges in ||·||_F; define h_mu = h S and verify the contraction identities by formal power series, then bound the truncation tail by the geometric series.

Summary
The stack uses a filtered complete dgLA to make square-zero structure and differentiation first-class invariants, and QMS-256 to supply a constant-size, exact, and bounded front end. With explicit envelopes and filtered control, all online passes are O(1), algebraically closed, and numerically stable. This formulation isolates assumptions, quantifies errors, and exposes a minimal ABI suitable for independent verification.
